# GLSL ES概述

GLSL ES编程语言是在OpenGL着色器语言（GLSL）的基础上，删除和简化了一部分功能后形成的。 

## 基础

- 程序区分大小写
- 每一个语句都应该以一个英文分号(;)结束

## 执行次序

着色器程序从main()函数开始执行。着色器程序必须有且只有一个main()函数，而且该函数不能接受任何参数。void关键字表示该函数不返回任何值。

在GLSL ES中，如果一个函数有返回值，就必须在定义函数时明确地指定返回值的类型，如果没有返回值，也需要用void来明确表示这个函数没有返回值。

## 注视

GLSL ES的注视和javascript的注视格式是相同的

- 单行注释：//
- 多行注释：/* 中间的所有字符串 */

## 数据值类型

GLSL ES支持两种数据值类型

- 数值类型：GLSL ES支持整形数和浮点数
- 布尔值类型：true和false

## 变量

- 只包括   字母、数字、下划线
- 变量名首字母不能是数字
- 不能是关键字和保留字
- 不能以 gl\_、 webgl\_、 _webgl\_开头

## GLSL ES是强类型语言

在定义函数时，必须指定函数的返回值，同样，在进行赋值操作(=)的时候，等号两边的数据类型也必须一样，否则会报错。

## 基本类型

| 类型  | 描述                                               |
| ----- | -------------------------------------------------- |
| float | 单精度浮点数类型，该类型的变量表示一个单精度浮点数 |
| int   | 整型数，表示整数                                   |
| bool  | 布尔值表示一个布尔值（true或false）                |

## 赋值和类型转换

使用等号(=)进行赋值变量，因为GLSL ES是强类型语言，所以等号左侧变量的类型与等号右侧的值类型必须一致

```c++
int i = 8; //没问题
int i1 = 8.0; //报错
float f1 = 8; //报错
float f2 = 8.0; //没问题
float f3 = 8.0f; //报错
```

语义上8和8.0是一个数值。但是，当你将8赋值给浮点型变量时就会报错。

要将一个整型数值赋值给浮点型变量，需要类型转换

```c++
int i = 8;
float f1 = float(i);
float f2 = float(8);
```

GLSL ES内置的类型转换函数

| 转换               | 函数        | 描述                                     |
| ------------------ | ----------- | ---------------------------------------- |
| 浮点数转换为整型数 | int(float)  | 将浮点数的小数部分删去，转换为整型数     |
| 布尔值转换为整型数 | int(bool)   | true被转换为1，false被转换为0            |
| 整型数转换为浮点数 | float(int)  | 将整型数转换为浮点数(比如，将8转换为8.0) |
| 布尔值转换为浮点数 | float(bool) | true被转换为1.0，false被转换为0.0        |
| 整型数转换为布尔值 | bool(int)   | 0内转换为false，其他非0值被转换为true    |
| 浮点数转换为布尔值 | bool(float) | 0.0被转换为false，其他非0值被转换为true  |

## 矢量与矩阵

GLSL ES支持矢量和矩阵类型，这两种数据类型和适合用来处理计算机图形。矢量和矩阵类型的变量都包含多个元素，每个元素是一个数值（整型数、浮点数、布尔值）。

| 类型 | GLSL ES数据类型     | 描述                            |
| ---- | ------------------- | ------------------------------- |
| 矢量 | vec2、vec3、vec4    | 具有2、3、4个浮点数元素的矢量   |
|      | Ivec2、ivec3、ivec4 | 具有2、3、4个整型数元素的矢量   |
|      | bvec2、bvec3、bvec4 | 具有2、3、4个布尔值元素的矢量   |
| 矩阵 | mat2、mat3、mat4    | 2x2、3x3、4x4的浮点数元素的矩阵 |

## 矢量构造函数

在GLSL ES中，矢量非常重要，所以GLSL ES提供了丰富灵活的方式来创建矢量

```c++
vec3 v3 = vec3(1.0, 0.0, 0.5); //将v3设为(1.0, 0.0, 0.5)
vec2 v2 = vec2(v3);  //将v3设为(1.0, 0.0)
vec2 v4 = vec2(1.0);  //将v3设为(1.0, 1.0, 1.0, 1.0)
```

v2会忽略第三个分量，v4会自动全部赋值给所有的元素，但是如果构造函数接受了不止1个参数，就会报错

## 矩阵构造函数

矩阵构造函数的使用方式和矢量的非常相似。

- 但是，需要保证存储在矩阵的元素时按照列主序排列的（数学中的矩阵时按照行主序排列的）

    ```js
    mat4 m4 = mat4(
        1.0,5.0, 9.0,13.0,
    2.0,6.0,10.0,14.0,
    3.0,7.0,11.0,15.0,
    4.0,8.0,12.0,16.0,
    )
    // 上面矩阵在数学中应该是如下排列
    // 1.0,  2.0,  3.0,  4.0,
    // 5.0,  6.0,  7.0,  8.0,
    // 9.0,  10.0, 11.0, 12.0,
    // 13.0, 14.0, 15.0, 16.0,
    ```
  
- 想矩阵构造函数中传入一个或多个矢量，按照列主序使用矢量里的元素值来构造矩阵

  ```c++
  // 使用两个vec2对象来创建mat2对象
  vec2 v2_1 = vec2(1.0, 3.0);
  vec2 v2_2 = vec2(2.0, 4.0);
  mat2 m2_1 = mat2(v2_1, v2_2);
  
  // 1.0 2.0
  // 3.0 4.0
  ```

- 