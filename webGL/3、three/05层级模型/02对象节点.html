<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<style>
    body{
        margin: 0;
    }
</style>
<body>
    
</body>
<script type="module">
    import {
        Scene,
        BoxGeometry,
        MeshLambertMaterial,
        Mesh,
        PointLight,
        AmbientLight,
        OrthographicCamera,
        WebGLRenderer,
        SphereGeometry,
        CylinderGeometry,
        AxesHelper,
        BufferGeometry,
        BufferAttribute,
        MeshBasicMaterial,
        DoubleSide,
        Vector3,
        Color,
        VertexColors,
        PointsMaterial,
        Points,
        Line,
        LineDashedMaterial,
        PlaneGeometry,
        DirectionalLight,
        SpotLight,
        Group,
        MeshPhongMaterial
    } from 'https://unpkg.com/three/build/three.module.js'
    import {OrbitControls} from 'https://threejsfundamentals.org/threejs/resources/threejs/r122/examples/jsm/controls/OrbitControls.js'
    //创建一个场景对象。
    const scene = new Scene() 
    // 头部模型
    const headMesh = creatSphereMesh(10, 0, 0, 0)
    headMesh.name = '脑袋'
    const leftMesh = creatSphereMesh(1, 8, 5, 4)
    leftMesh.name = '右眼'
    const rightMesh = creatSphereMesh(1, 8, 5, -4)
    rightMesh.name = '右眼'
    const headGroup = new Group()
    headGroup.add(headMesh, leftMesh, rightMesh)

    // 身体模型
    const neckMesh = createCylinderMesh(3, 10, 0, -15, 0)
    neckMesh.name="脖子"
    const bodyMesh = createCylinderMesh(14, 30, 0, -35, 0)
    bodyMesh.name="腹部"
    // 腿部结构
    const leftLegMesh = createCylinderMesh(4, 60, 0, -80, -7)
    leftLegMesh.name = '左腿'
    const rightLegMesh = createCylinderMesh(4, 60, 0, -80, 7)
    rightLegMesh.name = '右腿'
    const legGroup = new Group()
    legGroup.name="腿部"
    legGroup.add(leftLegMesh, rightLegMesh)

    const bodyGroup = new Group()
    bodyGroup.name = '身体'
    bodyGroup.add(neckMesh, bodyMesh, legGroup)

    const perspnGroup = new Group()
    perspnGroup.name = '人'
    perspnGroup.add(headGroup, bodyGroup)
    perspnGroup.translateY(50)
    scene.add(perspnGroup)

    console.log(scene);
    scene.traverse(obj=>{
        console.log(obj);
    })
    function createCylinderMesh(r, h, x, y, z) {
        const geometry = new CylinderGeometry(r,r,h, 25,25)
        const material = new MeshPhongMaterial({
            color: 0x0000ff
        })
        const mesh = new Mesh(geometry, material)
        mesh.position.set(x,y,z)
        return mesh
    }
    function creatSphereMesh(r, x, y, z){
        const geometry = new SphereGeometry(r, 25, 25)
        const material = new MeshPhongMaterial({
            color: 0x0000ff
        })
        const mesh = new Mesh(geometry, material)
        mesh.position.set(x, y, z)
        return mesh
    }


    const point = new PointLight(0xffffff, 0.5 )
    point.position.set(200, 200, 200)
    scene.add(point)
    // 初始化环境光，不需要设置位置
    const ambient = new AmbientLight(0x333333)
    // 将环境光添加到场景中
    scene.add(ambient)

    const width = window.innerWidth
    const height = window.innerHeight
    const k = width / height
    const s = 200

    // 初始化一个正交投影相机
    const camera = new OrthographicCamera(-s*k, s*k, s, -s, 1, 1000)
    // 设置相机位置
    camera.position.set(200, 300, 200)
    // 让相机看向场景位置
    camera.lookAt(scene.position)
    // 初始化渲染构造器
    const renderer =new WebGLRenderer()
    // 设置输出画布大小
    renderer.setSize(width, height)
    // 设置清除画布的颜色
    renderer.setClearColor(0xb9d3ff, 1)
    document.body.appendChild(renderer.domElement)

    // 创建一个定长的辅助坐标系
    const axesHelper = new AxesHelper(500)
    scene.add(axesHelper)

    function render() {
        renderer.render(scene, camera)
        requestAnimationFrame(render)
    }
    render()
    const controls = new OrbitControls(camera, renderer.domElement)
</script>
</html>